<!DOCTYPE html>
<html lang="en">
    <head>
        <title>SATAYA VACAHANA</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css">
        <link rel="stylesheet" type="text/css" href="formstyle.css">
        <link href='http://fonts.googleapis.com/css?family=Bitter' rel='stylesheet' type='text/css'>
        <link rel="icon" href="image1.png" type="image/icon type">
        <style>
          /* Center the loader */
          #loader {
            position: absolute;
            left: 50%;
            top: 50%;
            z-index: 1;
            width: 150px;
            height: 150px;
            margin: -75px 0 0 -75px;
            border: 16px solid #f3f3f3;
            border-radius: 50%;
            border-top: 16px solid black;
            width: 120px;
            height: 120px;
            -webkit-animation: spin 2s linear infinite;
            animation: spin 2s linear infinite;
          }
          
          @-webkit-keyframes spin {
            0% { -webkit-transform: rotate(0deg); }
            100% { -webkit-transform: rotate(360deg); }
          }
          
          @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }
          
          /* Add animation to "page content" */
          .animate-bottom {
            position: relative;
            -webkit-animation-name: animatebottom;
            -webkit-animation-duration: 1s;
            animation-name: animatebottom;
            animation-duration: 1s
          }
          
          @-webkit-keyframes animatebottom {
            from { bottom:-100px; opacity:0 } 
            to { bottom:0px; opacity:1 }
          }
          
          @keyframes animatebottom { 
            from{ bottom:-100px; opacity:0 } 
            to{ bottom:0; opacity:1 }
          }
          
          #myDiv {
            display: none;
            text-align: center;
          }
          </style>
      </head>
<body onload="loading()">
<!-- NAVBAR -->
<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>                        
      </button>
      <a class="navbar-brand" href="index.html"><img src="main_logo.png" width="60px"></a>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="index.html"> Home </a></li>
        <li><a href="about.html"> About Us </a></li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#"> Records <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li class="active"><a href="search.html"> Search Records </a></li>
            <li style="cursor: pointer;"><a onclick="loginauth1()"> Add Criminal Records </a></li>
            <li style="cursor: pointer;"><a href="modify.html"> Modify Criminal Records </a></li>
            <li style="cursor: pointer;"><a href="delete.html"> Delete Criminal Records </a></li>
          </ul>
        </li>
            <li><a href="contact.html"> Emergency Numbers </a></li>
<!-- MODAL LOGIN BUTTONS -->
            <li>
              <button class="btn" id="loginbtn" data-toggle="modal" data-target="#popUpWindow">
                <span class="glyphicon glyphicon-log-in" ></span> 
                Log In 
              </button>
              </li>
            <li>
              <button class="btn" id="btnLogout" style="display: none;" onclick="logout()"> 
                <span class="glyphicon glyphicon-log-out"></span> 
                Log Out 
              </button>
            </li>
      </ul>
    </div>
  </div>
</nav>
<!-- MODAL LOGIN -->
<div class="container">  
  <div class="modal fade" id="popUpWindow">
    <div class="modal-dialog">
      <div class="modal-content">
        <div id="login_div">
        <!-- header -->
        <div class="modal-header">
          <h3 class="modal-title">Login</h3>
        </div>
        <!-- body -->
        <div class="modal-header">
          <form role="form">
            <div class="form-group">
              <input type="email" id= "txtEmail" class="form-control" placeholder="Email"/>
              <br>
              <input type="password" id="txtPassword" class="form-control" placeholder="Password" />
              <br>
              <input type="button" onclick="myFunction()" onmouseover="myFunction()" onmouseout="myFunction()" value="Show Password">
            </div>
          </form>
        </div>
        <!-- footer -->
        <div class="modal-footer">
          <button class="btn btn-block" id="btnLogin" onclick="login()">Log In</button>
        </div>
        </div>
      <!-- success -->
      <div id="user_div" class="modal-success" style="display: none;">
        <h3 class="modal-title" style="text-align: center;">Logged In Successfully !!</h3>
      </div>
      </div>
    </div>
  </div>
</div>

<!-- JS for SHOW PASSWORD -->
<script>
  function myFunction() {
 var x = document.getElementById("txtPassword");
 if (x.type === "password") {
   x.type = "text";
 } else {
   x.type = "password";
 }
}
</script>
<!-- MODAL LOGIN ENDS -->

<div style="padding: 2%; min-height: 45vw;">
<!-- FORM -->
<div class="form-style-10" style="display: none;">
    <h1>Add to Criminal Record<span>Enter the Details of the Criminal</span></h1>
    <form id="addCriminal">
        <div class="section"><span>1</span>Personal Information</div>
        <div class="inner-wrap">
            <label>Full Name* <input type="text" id="cName" required></label>
            <label>Gender*<br>
                <input type="radio" id="cGender" name="gender" value="Male" required>Male
                <input type="radio" id="cGender" name="gender" value="Female" required>Female
                <input type="radio" id="cGender" name="gender" value="Other" required>Other
            </label>
            <label>Education <textarea id="cEducation"></textarea></label>
            <label>Date of Birth* <input type="date" id="cDOB" required></label>
            <label>Address<textarea id="cAdd"></textarea></label>
            <label>Address of Hometown<textarea id="cHomeAdd"></textarea></label>
            <label>Phone Number* <input type="tel" id="cPhone" pattern="[0-9]{10}" placeholder="10 Digits Phone Number Only" required></label>
            <label>E-Mail Id <input type="email" id="cMail"></label>
            <label>Father's Name <input type="text" id="cFather"></label>
            <label>Mother's Name <input type="text" id="cMother"></label>
            <label>Spouse's Name (if applicable) <input type="text" id="cSpouse"></label>
        </div>
    
        <div class="section"><span>2</span>Identification Details</div>
        <div class="inner-wrap">
            <label>Height (in cms) <input type="number" id="cHeight" min="0"></label>
            <label>Weight (in kgs) <input type="number" id="cWeight" min="0"></label>
            <label>Skin Colour <select id="cSkin">
                <option value="" disabled selected hidden> Select </option>
                <option value="Very Fair"> Very Fair </option>
                <option value="Fair"> Fair </option>
                <option value="Medium"> Medium </option>
                <option value="Olive">Olive </option>
                <option value="Brown">Brown </option>
                <option value="Dark Brown"> Dark Brown </option>
                </select>
            </label>
            <label>Body Type 
                <select id="cBody">
                <option value="" disabled selected hidden> Select </option>
                <option value="Skinny"> Skinny </option>
                <option value="Athletic"> Athletic </option>
                <option value="Bulky"> Bulky </option>
                </select>
            </label>
            <label>Birth Mark (if any) <input type="text" id="cMark"></label>  
        </div>
    
        <div class="section"><span>3</span>Past History</div>
        <div class="inner-wrap">
            <label>History of Crimes<textarea id="cCrimes"></textarea></label>
            <label>Awards Announced by Various Agencies (if caught) <textarea id="cAwards"></textarea></label>
        </div>
        <div class="section"><span>4</span>Contact Persons</div>
        <div class="inner-wrap">
            <label>Format: Name & Relation (with Mobile Number) <textarea id="cContact"></textarea></label>
        </div>

        <div class="button-section">
         <button id="submitForm"> Add Record</button>         
        </div>
    </form>
    </div>
<!-- FORM ENDS -->
<!-- TABLE -->
<div id="loader"></div>
<div style="display:none;" id="myDiv" class="animate-bottom">
<div style="padding: 5%;">
    <h2 style="text-align: center;"> <b>Search Criminal Record</b></h2>
    <br>
<table id="myTable">
  <thead>
    <tr>
      <th>Name</th>
      <th>Gender</th>
      <th>Date of Birth</th>
      <th>Phone Number</th>
    </tr>
  </thead>
  <tbody id="table_bdy">

  </tbody>
</table>
</div>
</div>
</div>

<!-- TABLE -->

<script>
    function myFunction() {
      var input, filter, table, tr, th, i, txtValue;
      input = document.getElementById("myInput");
      filter = input.value.toUpperCase();
      table = document.getElementById("myTable");
      tr = table.getElementsByTagName("tr");
      for (i = 0; i < tr.length; i++) {
        th = tr[i].getElementsByTagName("th")[0];
        if (th) {
          txtValue = th.textContent || th.innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1) {
            tr[i].style.display = "";
          } else {
            tr[i].style.display = "none";
          }
        }       
      }
    }




    </script>
<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/3.1.0/firebase.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->

<script>
  // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyCnbcOpPwZDdKvlSz-cVFfXAME-VIjaVV8",
    authDomain: "test-622c0.firebaseapp.com",
    databaseURL: "https://test-622c0.firebaseio.com",
    projectId: "test-622c0",
    storageBucket: "test-622c0.appspot.com",
    messagingSenderId: "81335831834",
    appId: "1:81335831834:web:816865eafc5607b19970a3"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
</script>


<script>
var contactRef = firebase.database().ref().child("criminalRecord");

document.getElementById("addCriminal").addEventListener("submit",submitForm);


function submitForm(e){
    e.preventDefault();

    var Name = getInputVal("cName");
    var Gender = getInputVal("cGender");
    var Education = getInputVal("cEducation");
    var DOB = getInputVal("cDOB");
    var Add = getInputVal("cAdd");
    var Home_Add = getInputVal("cHomeAdd");
    var Phone = getInputVal("cPhone");
    var Mail = getInputVal("cMail");
    var Father = getInputVal("cFather");
    var Mother = getInputVal("cMother");
    var Spouse = getInputVal("cSpouse");

    var Height = getInputVal("cHeight");
    var Weight = getInputVal("cWeight");
    var Skin = getInputVal("cSkin");
    var Body = getInputVal("cBody");
    var Mark = getInputVal("cMark");
    
    var History = getInputVal("cCrimes");
    var Awards = getInputVal("cAwards");

    var Contact = getInputVal("cContact");


    saveForm(Name, Gender, Education, DOB, Add, Home_Add, Phone, Mail, Father, Mother, Spouse, Height, Weight, Skin, Body, Mark, History, Awards, Contact);
    document.getElementById('addCriminal').reset();
}

function getInputVal(id){
    return document.getElementById(id).value;
}
 
function saveForm(Name, Gender, Education, DOB, Add, Home_Add, Phone, Mail, Father, Mother, Spouse, Height, Weight, Skin, Body, Mark, History, Awards, Contact){
    
    var newContactRef = contactRef.push();
    newContactRef.set({
        Name: Name,
        Gender: Gender,
        Education: Education,
        DOB: DOB,
        Address: Add, 
        Hometown_Adress: Home_Add,
        Phone_Number: Phone,
        Mail_ID: Mail,
        Father: Father,
        Mother: Mother,
        Spouse: Spouse,
        Height: Height,
        Weight: Weight,
        Skin_Colour: Skin,
        Body_Type: Body,
        Birth_Marks: Mark,
        Crime_History: History,
        Awards: Awards,
        Contact_Persons: Contact
    })
}

contactRef.on("child_added", snap=>{
  
  var Name = snap.child("Name").val();
  var Gender = snap.child("Gender").val();
  var DOB = snap.child("DOB").val();
  var Phone = snap.child("Phone_Number").val();
  

$('#table_bdy').append("<tr> <td>"+Name+"</td> <td>"+Gender+"</td> <td>"+DOB+"</td> <td>"+Phone+"</td> </tr>");
});



</script>



<!-- Footer -->
<div class="footer">
  <div class="f1">
    <p class="linkfooter">
      <img src="main_logo.png" width="80px" >
    </p>
  </div>
  <div class="f2">
    <p>
      Project By:
      <br>
      Umesh Kumar(20MIS0187)
      <br>
      Akanksha Hotta(20MIS0137)
      <br>
    </p>
    <span class="fl">
      &copy; Satyavachan, 2022, Version 1.4 (This website is for representation purpose only)
  </span>
  </div>
  <hr color="red">
        
</div>
<!-- End of Footer -->


<!-- JS for LoginAuth -->

<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/3.1.0/firebase.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->

<script>
  // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyCnbcOpPwZDdKvlSz-cVFfXAME-VIjaVV8",
    authDomain: "test-622c0.firebaseapp.com",
    databaseURL: "https://test-622c0.firebaseio.com",
    projectId: "test-622c0",
    storageBucket: "test-622c0.appspot.com",
    messagingSenderId: "81335831834",
    appId: "1:81335831834:web:816865eafc5607b19970a3"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
</script>

<script>
  //on auth state change
  firebase.auth().onAuthStateChanged(function(user) {
    if (user) 
    {
      // User is signed in.
      document.getElementById("user_div").style.display = "block";
      document.getElementById("login_div").style.display = "none";
      document.getElementById("btnLogout").style.display = "block";
      document.getElementById("loginbtn").style.display = "none";
    } 
    else 
    {
      // No user is signed in.
      document.getElementById("user_div").style.display = "none";
      document.getElementById("login_div").style.display = "block";
      document.getElementById("btnLogout").style.display = "none";
      document.getElementById("loginbtn").style.display = "block";
    }
  });

  //for login 
  function login()
  {
    var txtEmail = document.getElementById("txtEmail").value;
    var txtPass = document.getElementById("txtPassword").value;

    firebase.auth().signInWithEmailAndPassword(txtEmail, txtPass).catch(function(error) {
      // Handle Errors here.
      var errorCode = error.code;
      var errorMessage = error.message;
      window.alert(errorMessage);
      // ...
    });
  }
  
  //for logout
  function logout(){
    firebase.auth().signOut();
    location.reload(); 
  }

  //for add records authorisation
  function loginauth1()
    {
      var user = firebase.auth().currentUser;
      if (user)
      {
        location.replace("add.html");
      }
      else
      {
        window.alert("Login to Add in Criminal Record");
      }
    }
</script>
<!-- JS for LoginAuth Ends -->
<!-- JS for Loading -->
<script>
  var myVar;
  
  function loading() {
    myVar = setTimeout(showPage, 5000);
  }
  
  function showPage() {
    document.getElementById("loader").style.display = "none";
    document.getElementById("myDiv").style.display = "block";
  }
  </script>
</body>
</html>




